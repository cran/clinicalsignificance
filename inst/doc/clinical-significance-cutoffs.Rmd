---
title: "Clinical Significance Cutoffs"
author: Benedikt Claus
date: "`r format(Sys.time(), '%d-%m-%Y')`"
bibliography: references.bib
csl: apa.csl
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Clinical Significance Cutoffs}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE, message=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 5,
  fig.height = 4.5,
  fig.align = 'center'
)

library(tidyverse)
```

When conducting clinical significance analyses, you want to detect those patients that changed from the clinical population to the functional population. But how do you know that? In the clinical significance framework, this decision is based on whether a patient crosses a specific cutoff.

@Jacobson.1984 and @Jacobson.1991 defined three cutoffs that can be used to determine if a patient moved from the clinical to the functional population, namely $a$, $b$, and $c$. Below you can find more information on what the difference between these three cutoffs is, which one to choose and how different authors proposed to calculate them.

## Jacobson & Truax
If you imagine a dimensional outcome, e.g., a measure of depression, the clinical and functional population should form two distinct distributions on this dimension. In this specific example (see figure below), the clinical population (red line) can be described as a normal distribution with _M_ = 32 and an _SD_ = 7. The functional population (blue line) can be described as a normal distribution with _M_ = 10 and _SD_ = 7.

```{r, echo=FALSE}
distributions <- ggplot() +
  geom_function(fun = dnorm, args = list(mean = 10, sd = 7), aes(color = "Functional"), n = 200) +
  geom_function(fun = dnorm, args = list(mean = 32, sd = 7), aes(color = "Clinical"), n = 200) +
  expand_limits(x = c(-20, 70-3)) +
  theme_minimal() +
  theme(
    axis.line.x = element_line(),
    axis.text.y = element_blank(),
    panel.grid = element_blank(),
    legend.position = "bottom"
  ) +
  labs(x = "Depression Score", y = NULL, color = "Population")

distributions
```

### a and b
A reasonable cutoff between the clinical and functional population should ly between those. @Jacobson.1984 and @Jacobson.1991 proposed cutoffs $a$ and $b$ to be

$$a = M_{clin} - 2 SD_{clin}\\a = 32 - 2\cdot7\\a=18$$
and

$$b = M_{fun} + 2 SD_{clin}\\b=10+2\cdot7\\b=24$$
with $M_{clin}$ and $M_{fun}$ being the means of the clinical and functional population and $SD_{clin}$ being the standard deviation of the clinical population. Of note is that both cutoffs incorporate the clinical population's standard deviation but the "starting point" is different. In $a$, it is the clinical population's mean and in $b$ it is the functional population's mean.

Of importance here is the direction of beneficial effect. In this example, a lower depression score is beneficial to the patient. In other examples, the opposite may be true, e.g., in a measure of quality of life, where higher values are desirable. In this case, the plus and minus signs in the formulas above are switched.

If we incorporate both cutoffs $a$ and $b$ into the figure above, we get the following picture.

```{r, echo=FALSE}
a <- clinicalsignificance:::.calc_cutoff_jt(32, 7, 10, 7, type = "a", direction = -1)$value
b <- clinicalsignificance:::.calc_cutoff_jt(32, 7, 10, 7, type = "b", direction = -1)$value
c <- clinicalsignificance:::.calc_cutoff_jt(32, 7, 10, 7, type = "c", direction = -1)$value

distributions +
  geom_vline(xintercept = a, linetype = "dashed") +
  geom_vline(xintercept = b, linetype = "dashed") +
  geom_label(aes(label = "a"), x = a, y = 0.05, label.r = unit(0, "lines")) +
  geom_label(aes(label = "b"), x = b, y = 0.05, label.r = unit(0, "lines"))
```

With overlapping distributions, $a$ seems to be more conservative and $b$ seems to be more liberal in deciding whether a patient moved from the clinical into the functional population.

### c
A more reasonable cutoff, however, may be one that incorporates both, mean and standard deviation, of _both_ populations. This is what $c$ is designed to do. It is defined as

$$c = \frac{SD_{fun}M_{clin} + SD_{clin}M_{fun}}{SD_{fun} + SD_{clin}}\\c=\frac{7\cdot32+7\cdot10}{7+7}\\c=21$$
with $M$ and $SD$ being the mean and standard deviation and the indexes $fun$ and $clin$ indicating the functional and clinical population. This cutoff lays in between both populations as can be seen in the figure below.

```{r}
distributions +
  geom_vline(xintercept = c, linetype = "dashed") +
  geom_label(aes(label = "c"), x = c, y = 0.05, label.r = unit(0, "lines"))
```

Because of that, **$c$ is generally recommended**. So, if you have descriptive statistics for the functional population, you should always use $c$! You This ensures comparability of clinical significance analyses. If you deviate from this approach, clearly explain why you did that and give detailed reasons for doing so. An obstacle might be the availability of descriptives for the functional population that are needed to calculate $c$. However, these should be known for the most common instruments in psychological research. If not, it might be a good idea to determine those metrics first!

## Plot Cutoffs
A simple way to check your cutoffs is with `check_cutoff()`

```{r, fig.width=8}
library(clinicalsignificance)

check_cutoff(m_clinical = 32, sd_clinical = 7, m_functional = 10, sd_functional = 7, type = "c")
```


## Hageman & Arrindell
@Hageman.1999 proposed $a$, $b$, and $c$ to be expressed as true scores by principles of classical test theory. To obtain the true scores for $a$, $b$, and $c$, i.e., $a_{true}$, $b_{true}$, and $c_{true}$, the standard deviations in the formulas proposed by @Jacobson.1991 must be multiplied with the respective reliability.

$$a_{true} = M_{clin} - 2 SD_{clin} \sqrt{r_{xx(clin)}}$$

with 

$$\sqrt{r_{xx(clin)}} = \frac{SD_{clin}^2 - S_E}{SD_{clin}^2}$$

and 

$$S_E = SD_{sample}\sqrt{1 - r_{sample}}$$

with $SD_{sample}$ and $r_{sample}$ being the standard deviation and reliability coefficient of a specific sample. This sample may be the clinical or the functional population. The reliability coefficient should, again, be a measure of internal consistency.

$b_{true}$ is defined as

$$b_{true} = M_{fun} + 2 SD_{clin}\sqrt{r_{xx(clin)}}$$
Bear in mind that the direction of the beneficial is of importance here as well. The formulas above are for outcome in which a lower score indicates a beneficial outcome. If higher values are desirable, the plus and minus signs in the formulas for $a_{true}$ and $b_{true}$ must be switched.

$c_{true}$ is defined as

$$c_{true} = \frac{SD_{fun}\sqrt{r_{xx(fun)}}M_{clin} + SD_{clin}\sqrt{r_{xx(clin)}}M_{fun}}{SD_{fun}\sqrt{r_{xx(fun)}} + SD_{clin}\sqrt{r_{xx(clin)}}}$$
with 

$$\sqrt{r_{xx(fun)}} = \frac{SD_{fun}^2 - S_E}{SD_{fun}^2}$$
